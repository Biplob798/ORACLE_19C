SELECT
    pc.CATEGORY_NAME AS type,
    TO_CHAR(o.SALE_DATE, 'MON RRRR') AS month,
    SUM(NVL(oi.QUANTITY,0) * NVL(oi.PRICE,0)) AS sales
FROM SELL_ORDER_DETAILS oi
JOIN PRODUCTS p
    ON oi.PRODUCT_ID = p.PRODUCT_ID
JOIN PRODUCT_CATEGORY pc
    ON p.CATEGORY_ID = pc.CATEGORY_ID
JOIN SELL_ORDER_MASTER o
    ON oi.SELL_ORDER_ID = o.SELL_ORDER_ID
GROUP BY
    pc.CATEGORY_NAME,
    TO_CHAR(o.SALE_DATE, 'MON RRRR'),
    TO_CHAR(o.SALE_DATE, 'YYYYMM')
ORDER BY
    TO_CHAR(o.SALE_DATE, 'YYYYMM');
