SELECT 
    pc.CATEGORY_NAME AS label,
    SUM(NVL(oi.QUANTITY,0) * NVL(oi.PRICE,0)) AS total_sales
FROM SELL_ORDER_MASTER o
JOIN SELL_ORDER_DETAILS oi
    ON o.SELL_ORDER_ID = oi.SELL_ORDER_ID
JOIN PRODUCTS p
    ON oi.PRODUCT_ID = p.PRODUCT_ID
JOIN PRODUCT_CATEGORY pc
    ON p.CATEGORY_ID = pc.CATEGORY_ID
GROUP BY pc.CATEGORY_NAME
ORDER BY total_sales DESC;
