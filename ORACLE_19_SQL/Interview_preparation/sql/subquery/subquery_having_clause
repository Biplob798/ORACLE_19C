-- The HAVING clause is used when you are using aggregate functions (like MIN, MAX, or AVG). Here, the subquery helps filter groups based on a calculated value.


SELECT department_id, MIN(hire_date)
FROM employees
GROUP BY department_id
HAVING MIN(hire_date) > (SELECT hire_date 
                         FROM employees 
                         WHERE last_name = 'Davies');




 SELECT department_id, MIN(salary)
FROM employees
GROUP BY department_id
HAVING MIN(salary) >

(SELECT MIN(salary)
FROM employees
WHERE department_id = 30);                        



-- Find the job with the lowest average salary.



SELECT job_id, AVG(salary)
FROM employees
GROUP BY job_id
HAVING AVG(salary) = (SELECT MIN(AVG(salary))
FROM employees
GROUP BY job_id);




                         