
-- conn hr/hr@localhost:1521/orclpdb66.mshome.net   

select last_name,hire_date
from employees 
where department_id=(
    select department_id
    from employees 
    where upper(last_name)=upper('&enter_name')
    )
    and upper(last_name)<>upper('&enter_name');


CREATE TABLE D_EMPLOYEES(
    employee_id   number,
    last_name     varchar2(100) not null,
    email         varchar2(100),
    salary        number,
    commission_pct number(2,2),
    hire_date       date not null,
    department_id number,
    constraint emp_emp_dept_fk foreign key (department_id) references departments(department_id),constraint emp_emp_dept_uk unique(email)
);


create table teach_emp(
    empno       number(5) primary key,
    ename       varchar2(100) not null,
    job         varchar2(100),
    mgr         number(5),
    hiredate    date default sysdate,
    photo       blob,
    salary      number(7,2),
    deptno      number(3) not null constraint admin_dept_fkey references departments(department_id)

);


create table dept80
 as
 select employee_id,last_name,salary*12 annsal,hire_date from employees where department_id=80; 






SELECT last_name, hire_date 
FROM employees 
WHERE department_id = (
    SELECT department_id 
    FROM employees 
    WHERE UPPER(last_name) = UPPER('zlotkey')
)
AND UPPER(last_name) <> UPPER('zlotkey');






select employee_id, last_name, salary  
from employees 
where department_id in (
    select department_id 
    from employees 
    where last_name like '%u%'
    ) 
    and salary >(select avg(salary) from employees);


select employee_id, last_name, salary  
from employees 
where salary > (select avg(salary) from employees)
    and department_id in (
    select department_id 
    from employees 
    where last_name like '%u%'
    ) ;








select last_name, job_id, salary 
from employees 
where job_id=(
    select job_id from employees where last_name='Taylor'
    )
    and salary>(
        select salary 
        from employees 
        where last_name ='Taylor'
        );



select e.last_name,e.job_id,e.department_id,d.department_name from employees e join departments d on (e.department_id=d.department_id) join locations l using(location_id) where l.city='Toronto';


select e.last_name,e.employee_id,m.last_name,m.employee_id from employees e join employees m on(e.manager_id=m.employee_id);



 select  e.last_name, e.hire_date from employees e join  employees davies on(davies.last_name='Davies') where davies.hire_date<e.hire_date;


 select last_name,hire_date from employees where hire_date>(select hire_date from employees where last_name='Davies')




 select e.last_name,e.hire_date,m.last_name,m.hire_date from employees e join employees m on (e.manager_id=m.employee_id) where m.hire_date<e.hire_date;





 select last_name, hire_date from employees where department_id in(select department_id from employees where last_name= '&last_name') and last_name<>'&last_name';

select employee_id, last_name,salary from employees where salary >(select avg(salary) from employees) order by salary;


select employee_id,last_name from employees where department_id in(select department_id from employees where last_name like'%u%');


select last_name,department_id,job_id from employees where department_id in( select department_id from departments where location_id=1700);

select last_name,salary from employees where manager_id in(select employee_id from employees where last_name='King');

select department_id,last_name,job_id from employees where department_id in (select department_id from departments where department_name='Executive');

select last_name from employees where salary > any(select salary from employees where department_id= 60);


select last_name from employees where department_id in(select department_id from employees where last_name like '%u%')and salary> (select avg(salary)from employees);



select job_id,count(job_id) from employees where job_id ='&job_id' group by job_id ;

SELECT count(DISTINCT manager_id) FROM employees;

SELECT MAX(SALARY)-MIN(SALARY) FROM EMPLOYEES;

SELECT MANAGER_ID, MIN(SALARY) FROM EMPLOYEES WHERE MANAGER_ID IS NOT NULL group by MANAGER_ID HAVING MIN(SALARY)>6000 ORDER BY MIN(SALARY); 

SELECT count(*) TOTAL, SUM(DECODE(TO_CHAR(hire_date,'YYYY'),'2005',1,0)) "2005",
                       SUM(DECODE(TO_CHAR(hire_date,'YYYY'),'2006',1,0)) "2006",
                       SUM(DECODE(TO_CHAR(hire_date,'YYYY'),'2007',1,0)) "2007",
                       SUM(DECODE(TO_CHAR(hire_date,'YYYY'),'2008',1,0)) "2008"
FROM EMPLOYEES;


SELECT count(*) TOTAL, SUM(CASE WHEN TO_CHAR(hire_date,'YYYY') ='2005' THEN 1 ELSE 0 END) "2005",
                       SUM(CASE WHEN TO_CHAR(hire_date,'YYYY') ='2006' THEN 1 ELSE 0 END) "2006",
                       SUM(CASE WHEN TO_CHAR(hire_date,'YYYY') ='2007' THEN 1 ELSE 0 END) "2007",
                       SUM(CASE WHEN TO_CHAR(hire_date,'YYYY') ='2008' THEN 1 ELSE 0 END) "2008"
FROM EMPLOYEES;



SELECT job_id,  SUM(CASE WHEN department_id=20 THEN SALARY ELSE 0 END),
                SUM(CASE WHEN department_id=50 THEN SALARY ELSE 0 END),
                SUM(CASE WHEN department_id=80 THEN SALARY ELSE 0 END),
                SUM(CASE WHEN department_id=90 THEN SALARY ELSE 0 END)
FROM EMPLOYEES group BY job_id;


SELECT job_id, SUM(DECODE (department_id,20,SALARY)),               
               SUM(DECODE (department_id,50,SALARY)),               
               SUM(DECODE (department_id,80,SALARY)),              
               SUM(DECODE (department_id,90,SALARY)),
               SUM(SALARY)
FROM EMPLOYEES group BY job_id;        



SELECT e.last_name,e.job_id,e.department_id,d.department_name FROM EMPLOYEES e join departments d on (e.department_id=d.department_id) join locations l using (location_id) WHERE l.city='Toronto';
               
select w.last_name,w.employee_id,m.last_name,m.employee_id from employees w join employees m on (w.manager_id=m.employee_id); 
select w.last_name,w.employee_id,m.last_name,m.employee_id from employees w left outer join employees m on (w.manager_id=m.employee_id); 


select e.department_id,e.last_name,c.last_name from employees e join employees c on (e.employee_id=c.employee_id) where e.employee_id<>c.employee_id;


select e.last_name,e.hire_date from employees e join employees davies on(davies.last_name='Davies') where davies.hire_date<e.hire_date;

select last_name,hire_date from employees where hire_date >(select hire_date from employees where last_name= 'Davies');

select e.last_name,e.hire_date,m.last_name,m.hire_date from employees e join employees m on(e.manager_id=m.employee_id)where e.hire_date<m.hire_date;



select last_name,e.job_id,e.department_id from employees e join departments d on(e.department_id=d.department_id) join locations l using(location_id) where l.city='Toronto'; 
 

 select last_name,lpad(salary,15,'$') from employees;

 select last_name,nvl(to_char(commission_pct),'No Commission') from employees;

 select last_name,hire_date from employees where hire_date>(select hire_date from employees where last_name='Davies');
 select e.last_name,e.hire_date from employees e join employees davies on(davies.last_name='Davies') where e.hire_date>davies.hire_date;

 select employee_id,last_name from employees where salary>(select avg(salary) from employees);

 select last_name,salary from employees where salary between 5000 and 12000 and department_id in(20,50);

 select last_name,department_id,job_id from employees where department_id in(select department_id from departments where location_id=1700);


 select last_name,department_id,job_id from employees where department_id in(select department_id from departments where location_id=1700);

 select last_name,hire_date,salary from employees where (salary,nvl(commission_pct,0))in(select salary,nvl(commission_pct,0) from employees where last_name='Kochhar') and last_name<>'Kochhar';

select last_name,hire_date,salary from employees where salary,nvl(commission_pct,0) in(select last_name,nvl(commission_pct,0) from employees where last_name ='Kochhar') and last_name<>'Kochhar';




select e.last_name,e.hire_date,m.last_name,m.hire_date from employees e join employees m on (e.manager_id=m.employee_id) where m.hire_date<e.hire_date;





select e.last_name,e.hire_date,m.last_name,m.hire_date from employees e join employees m on (e.manager_id=m.employee_id) where m.hire_date<e.hire_date;





--  select last_name, hire_date from employees where department_id in(select department_id from employees where last_name= '&last_name') and last_name<>'&last_name';

-- select employee_id, last_name,salary from employees where salary >(select avg(salary) from employees) order by salary;


-- select employee_id,last_name from employees where department_id in(select department_id from employees where last_name like'%u%');


-- select last_name,department_id,job_id from employees where department_id in( select department_id from departments where location_id=1700);

-- select last_name,salary from employees where manager_id in(select employee_id from employees where last_name='King');

-- select department_id,last_name,job_id from employees where department_id in (select department_id from departments where department_name='Executive');

-- select last_name from employees where salary > any(select salary from employees where department_id= 60);


-- 
-- select employee_id,last_name,salary from employees where department_id in(select department_id from employees where last_name like '%u%') and salary>(select avg(salary) from employees);



-- select last_name,hire_date from employees where department_id in (select department_id from employees where last_name='&lastName' ) and last_name<>'&lastName';

-- select employee_id,last_name,salary from employees where salary > (select avg(salary) from employees);


-- select employee_id,last_name from employees where department_id in(select department_id from employees where last_name like '%u%');



-- select last_name,department_id,job_id from employees where department_id in(select department_id from departments where location_id=1700);

-- select e.last_name,e.department_id,e.job_id from employees e join departments d on (e.department_id=d.department_id) where d.location_id=1700;

-- select last_name,department_id,job_id from employees e join departments d using (department_id) where d.location_id=1700;


-- select last_name , salary from employees where manager_id in(select employee_id from employees where last_name='King');


-- select last_name,salary from employees where manager_id in (select employee_id from employees where last_name='King');


-- select department_id,last_name,job_id from employees where department_id in(select department_id from departments where department_name='Executive');

-- select department_id,last_name,job_id from employees where department_id in(select department_id from departments where department_name='Executive');

-- select last_name from employees where salary> any(select salary from employees where department_id=60);


-- select last_name from employees where salary > any (select salary from employees where department_id=60);




select employee_id,last_name,salary from employees where department_id in(select department_id from employees where last_name like '%u%') and salary>(select avg(salary) from employees);


select employee_id,last_name,salary from employees where department_id in(select department_id from employees where last_name like '%u%') and salary> (select avg(salary) from employees);


select last_name,employee_id,salary from employees where salary>(select avg(salary) from employees);

select employee_id,last_name from employees where department_id in (select department_id from employees where last_name like '%u%');

select last_name,department_id,job_id from employees where department_id in(select department_id from departments where location_id=1700);

select last_name,salary from employees where manager_id in (select employee_id from employees where last_name ='King');


select department_id,last_name,job_id from employees where department_id in(select department_id from departments where department_name='Executive');

select employee_id from employees where salary >any(select avg(salary) from employees where department_id=60);

select employee_id,last_name,salary from employees where department_id in(select department_id from employees where last_name like'%u%') and salary>(select avg(salary) from employees);

-- select e.last_name,e.department_id,e.job_id,d.department_name from employees e join departments d on (e.department_id=d.department_id) join locations  l using(location_id) where l.city='Toronto';



-- SELECT e.last_name,e.job_id,e.department_id,d.department_name FROM EMPLOYEES e join departments d on (e.department_id=d.department_id) join locations l using (location_id) WHERE l.city='Toronto';
               
-- select w.last_name,w.employee_id,m.last_name,m.employee_id from employees w join employees m on (w.manager_id=m.employee_id); 
-- select w.last_name,w.employee_id,m.last_name,m.employee_id from employees w left outer join employees m on (w.manager_id=m.employee_id); 


-- select e.department_id,e.last_name,c.last_name from employees e join employees c on (e.employee_id=c.employee_id) where e.employee_id<>c.employee_id;


-- select e.last_name,e.hire_date from employees e join employees davies on(davies.last_name='Davies') where davies.hire_date<e.hire_date;

-- select last_name,hire_date from employees where hire_date >(select hire_date from employees where last_name= 'Davies');

-- select e.last_name,e.hire_date,m.last_name,m.hire_date from employees e join employees m on(e.manager_id=m.employee_id)where e.hire_date<m.hire_date;



-- select last_name,e.job_id,e.department_id from employees e join departments d on(e.department_id=d.department_id) join locations l using(location_id) where l.city='Toronto'; 
 


select e.employee_id,e.last_name, m.employee_id,m.last_name from employees e join employees m on(e.manager_id=m.employee_id);

 select e.last_name,e.department_id,c.last_name from employees e join employees c on (e.department_id=c.department_id) and e.employee_id<>c.employee_id;

 select last_name,hire_date from employees where hire_date>(select hire_date from employees where last_name='Davies');


 select e.last_name,e.hire_date ,m.last_name,m.hire_date from employees e join employees m on(e.manager_id=m.employee_id) where e.hire_date <m.hire_date;


 select e.employee_id,e.last_name,m.employee_id,m.last_name from employees e join employees m on(e.manager_id=m.employee_id) where e.hire_date<m.hire_date;


 select job_id,count(*) from employees where job_id='&id' group by job_id;

 select count( DISTINCT manager_id) from employees ;



 select count(distinct manager_id) FROM employees;

 select manager_id,min(salary) from employees where manager_id is not null group by manager_id HAVING min(salary)>6000 ;




 select manager_id,min(salary) from employees  where manager_id is not null group by manager_id HAVING min(salary)>6000;



 select count(*),sum(decode(to_char(hire_date,'yyyy'),2005,1,0)) "2005" from employees;

 select job_id, sum(decode(department_id,20,salary)) "dp20" ,sum(salary) from employees group by job_id;


 select last_name,length(last_name) from employees where last_name like'J%';



 select last_name,months_between(sysdate,hire_date) from employees;


 select last_name, lpad(salary,15,'$') from employees;

 select last_name,trunc((sysdate-hire_date)/7) from employees where department_id=70;


 select last_name, salary from employees where salary not between 5000 and 12000;


 select last_name,job_id from employees where manager_id is null;

 select employee_id,last_name,salary,department_id from employees where manager_id='&manager_id' and order by &column;


 select employee_id,last_name,salary,department_id from employees where manager_id=&manager_id order by &column;

 select last_name,job_id,salary from employees where job_id in('SA_REP','ST_CLERK');






--  sql_part_2------------------

insert into departments(department_id,department_name,manager_id,location_id)
values (280,'Public Relations',100,1700);

-- insert null values implicit method
insert into departments (department_id,department_name)
values(290,'Purchasing');
-- insert null values explicit method

insert into departments
values(300,'Finance',null,null);
  
-- insert special values 
insert into employees (employee_id,first_name, last_name,email, phone_number,hire_date,job_id,salary,commission_pct,manager_id,department_id)
values(207,'Bouis', 'Bopp','BPOPP', '515.124.4567',current_date, 'AC_ACCOUNT', 6900,null, 205,110);


-- insert SPECIFIC DATE AND  TIME VALUES 
insert INTO EMPLOYEES
VALUES (208,'Dden','Raphealy','DDRAPHEAL','515.127.4561',TO_DATE('FEB 3, 2025', 'MON DD, YYYY'),'SA_REP',11000,.2,100,60);


-- CREATE SCRIPT

insert into departmentS (department_id,department_name,location_id)
values(&department_id,'&department_name',&location_id);


-- COPING ROWS FROM ANOTHER TABLE

insert INTO SALES_REPS(ID,NAME,SALARY,commission_pct)
SELECT employee_id,last_name,SALARY,commission_pct FROM EMPLOYEES WHERE job_id LIKE 'REP%';




-- UPDATE ROW 

UPDATE EMPLOYEES SET job_id='IT_PROG', commission_pct=NULL
WHERE employee_id=114;


UPDATE EMPLOYEES SET (job_id,SALARY)=(SELECT job_id,SALARY FROM EMPLOYEES WHERE employee_id=205) WHERE employee_id=103;

UPDATE EMPLOYEES 
SET job_id=(SELECT job_id FROM EMPLOYEES WHERE employee_id=205),
    SALARY=(SELECT SALARY FROM EMPLOYEES WHERE employee_id=205)
    WHERE employee_id =103;

UPDATE COPY_EMP 
SET department_id =(SELECT department_id FROM EMPLOYEES WHERE employee_id=100)
    WHERE job_id=(SELECT job_id FROM EMPLOYEES WHERE employee_id=200);



-- DELETE ROW FROM TABLE
DELETE FROM departments WHERE department_name='Finance';_____?
select * FROM departments WHERE department_name='Finance';_____?

DELETE from employees where employee_id=114;
DELETE from departments where department_id in(30,40);

DELETE from employees where department_id in (select department_id from departmentS where department_name like '%Public%');


-- truncate 
truncate table employees;
