-- MASTER–DETAIL PRODUCT REPORT
SELECT 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME,
    pt.TYPE_NAME,
    p.PRODUCT_ID,
    p.PRODUCT_NAME,
    p.PURCHASE_PRICE,
    p.SELL_PRICE,
    p.UNIT_PRICE,
    p.STOCK_QTY,
    (p.PURCHASE_PRICE * p.STOCK_QTY) AS TOTAL_STOCK_VALUE,
    p.SKU,
    p.DESCRIPTION,
    p.CREATED_DATE,
    p.UPDATED_DATE
FROM PRODUCTS p
LEFT JOIN PRODUCT_CATEGORY pc ON p.CATEGORY_ID = pc.CATEGORY_ID
LEFT JOIN PRODUCT_BRAND pb ON p.BRAND_ID = pb.BRAND_ID
LEFT JOIN PRODUCT_TYPE pt ON p.TYPE_ID = pt.TYPE_ID
ORDER BY 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME,
    pt.TYPE_NAME,
    p.PRODUCT_NAME;
-- GROUP ABOVE REPORT (Category → Brand → Type → Product)
SELECT 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME,
    pt.TYPE_NAME,
    p.PRODUCT_ID,
    p.PRODUCT_NAME,
    p.PURCHASE_PRICE,
    p.SELL_PRICE,
    p.UNIT_PRICE,
    p.STOCK_QTY,
    (p.PURCHASE_PRICE * p.STOCK_QTY) AS TOTAL_STOCK_VALUE,
    p.SKU,
    p.DESCRIPTION
FROM PRODUCTS p
LEFT JOIN PRODUCT_CATEGORY pc ON p.CATEGORY_ID = pc.CATEGORY_ID
LEFT JOIN PRODUCT_BRAND pb ON p.BRAND_ID = pb.BRAND_ID
LEFT JOIN PRODUCT_TYPE pt ON p.TYPE_ID = pt.TYPE_ID
ORDER BY 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME,
    pt.TYPE_NAME,
    p.PRODUCT_NAME;
-- MATRIX REPORT (CATEGORY vs BRAND) - STOCK SUMMARY
SELECT 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME,
    SUM(p.STOCK_QTY) AS TOTAL_STOCK
FROM PRODUCTS p
LEFT JOIN PRODUCT_CATEGORY pc ON p.CATEGORY_ID = pc.CATEGORY_ID
LEFT JOIN PRODUCT_BRAND pb ON p.BRAND_ID = pb.BRAND_ID
GROUP BY 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME
ORDER BY 
    pc.CATEGORY_NAME,
    pb.BRAND_NAME;
